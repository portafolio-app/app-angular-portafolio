<!-- Modal con backdrop mejorado -->
<div *ngIf="isVisible && config"
     class="fixed inset-0 z-[9999] flex items-center justify-center p-2 sm:p-4
            transition-all duration-500 ease-out"
     [class.opacity-0]="!showAnimation"
     [class.opacity-100]="showAnimation"
     [class.pointer-events-none]="!isVisible || isClosing"
     [class.pointer-events-auto]="isVisible && !isClosing"
     [ngClass]="getPositionClass()"
     (click)="onBackdropClick($event)">

  <!-- Backdrop con efecto blur y gradiente -->
  <div class="absolute inset-0 bg-gradient-to-br from-black/60 via-gray-900/70 to-black/60
              backdrop-blur-md transition-all duration-500"
       [class.opacity-0]="!showAnimation"
       [class.opacity-100]="showAnimation">
  </div>

  <!-- Alert Container -->
  <div class="relative w-full max-h-[95vh] overflow-hidden
              transform transition-all duration-500 ease-out"
       [ngClass]="getSizeClass()"
       [class.scale-90]="!showAnimation"
       [class.scale-100]="showAnimation"
       [class.translate-y-8]="!showAnimation"
       [class.translate-y-0]="showAnimation"
       [class.rotate-1]="!showAnimation"
       [class.rotate-0]="showAnimation"
       (click)="$event.stopPropagation()">

    <!-- Alert Card con glassmorphism -->
    <div class="bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-2xl sm:rounded-3xl
                shadow-2xl border border-white/20 dark:border-gray-700/30 overflow-hidden
                transform transition-all duration-500 hover:shadow-3xl
                ring-1 ring-black/5 dark:ring-white/10"
         [ngClass]="getAlertClasses()">

      <!-- Progress Bar mejorada -->
      <div *ngIf="config.showProgress && config.autoClose && config.autoClose > 0"
           class="h-1.5 bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 overflow-hidden">
        <div class="h-full transition-all ease-linear shadow-lg"
             [ngClass]="getProgressBarClass()"
             [style.width.%]="progressWidth">
        </div>
      </div>

      <!-- Header con gradiente y mejor diseÃ±o -->
      <div class="relative flex items-start justify-between p-4 sm:p-6 border-b border-gray-100/50 dark:border-gray-700/50"
           [ngClass]="getHeaderClass()">

        <!-- Decorative elements -->
        <div class="absolute top-0 left-0 w-full h-full opacity-5 dark:opacity-10">
          <div class="absolute top-4 left-6 w-8 h-8 rounded-full bg-current animate-pulse"></div>
          <div class="absolute top-8 right-12 w-4 h-4 rounded-full bg-current animate-pulse delay-1000"></div>
          <div class="absolute bottom-4 left-1/3 w-6 h-6 rounded-full bg-current animate-pulse delay-500"></div>
        </div>

        <!-- Icon & Content -->
        <div class="relative flex items-start space-x-3 sm:space-x-4 flex-1 z-10">
          <!-- Icon mejorado -->
          <div *ngIf="config.showIcon !== false"
               class="flex-shrink-0 w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl flex items-center justify-center
                      shadow-lg transform transition-all duration-300 hover:scale-110 hover:rotate-6
                      ring-4 ring-white/50 dark:ring-gray-800/50"
               [ngClass]="getIconBackgroundClass()">
            <i [class]="getIconClass()"
               [ngClass]="getIconColorClass()"
               class="text-xl sm:text-2xl drop-shadow-sm"></i>
          </div>

          <!-- Title & Message -->
          <div class="flex-1 min-w-0">
            <h3 class="text-lg sm:text-xl lg:text-2xl font-bold mb-2 sm:mb-3 leading-tight
                       bg-gradient-to-r from-current to-current/80 bg-clip-text"
                [ngClass]="getTitleColorClass()">
              {{ config.title }}
            </h3>
            <div class="text-sm sm:text-base leading-relaxed prose prose-sm sm:prose-base max-w-none
                        text-opacity-90"
                 [ngClass]="getMessageColorClass()"
                 [innerHTML]="formatMessage(config.message || '')">
            </div>
          </div>
        </div>

        <!-- Close Button mejorado -->
        <button *ngIf="config.dismissible !== false"
                type="button"
                class="flex-shrink-0 ml-2 sm:ml-4 p-2 sm:p-2.5 rounded-lg sm:rounded-xl
                       text-gray-400 hover:text-gray-600 dark:hover:text-gray-300
                       hover:bg-white/80 dark:hover:bg-gray-700/80
                       transition-all duration-300 transform hover:scale-110 active:scale-95 hover:rotate-90
                       focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-600
                       backdrop-blur-sm border border-gray-200/50 dark:border-gray-600/50
                       shadow-md hover:shadow-lg"
                aria-label="Cerrar alerta"
                [disabled]="isClosing"
                (click)="handleCloseButton($event)">
          <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- Content scrollable area -->
      <div class="max-h-[60vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent">
        <!-- Actions mejoradas -->
        <div *ngIf="config.actions && config.actions.length > 0"
             class="flex flex-col sm:flex-row items-stretch sm:items-center
                    justify-end gap-2 sm:gap-3 px-4 sm:px-6 py-4 sm:py-6
                    bg-gradient-to-br from-gray-50/80 to-white/40
                    dark:from-gray-900/50 dark:to-gray-800/30
                    backdrop-blur-sm">

          <button *ngFor="let action of config.actions; let i = index; trackBy: trackByAction"
                  type="button"
                  class="group relative px-4 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-semibold rounded-lg sm:rounded-xl
                         transition-all duration-300 transform hover:scale-105 active:scale-95 hover:-translate-y-1
                         flex items-center justify-center space-x-2
                         focus:outline-none focus:ring-4 focus:ring-offset-2
                         shadow-md hover:shadow-xl
                         overflow-hidden min-h-[44px]"
                  [ngClass]="getActionButtonClass(action.style || 'secondary')"
                  [disabled]="isClosing"
                  [style.animation-delay]="(i * 100) + 'ms'"
                  (click)="handleActionButton(action.action, $event)">

            <!-- Animated background -->
            <div class="absolute inset-0 bg-gradient-to-r opacity-0 group-hover:opacity-20
                        transition-opacity duration-300"
                 [ngClass]="getActionButtonHoverClass(action.style || 'secondary')">
            </div>

            <!-- Content -->
            <div class="relative z-10 flex items-center space-x-2">
              <i *ngIf="action.icon"
                 [class]="action.icon"
                 class="text-sm group-hover:scale-110 transition-transform duration-300"></i>
              <span class="font-medium">{{ action.label }}</span>
            </div>

            <!-- Ripple effect -->
            <div class="absolute inset-0 rounded-lg sm:rounded-xl opacity-0 group-active:opacity-30
                        bg-gradient-radial from-white/50 to-transparent
                        transform scale-0 group-active:scale-100
                        transition-all duration-200">
            </div>
          </button>
        </div>
      </div>
    </div>

    <!-- Floating particles decoration -->
    <div class="absolute -top-4 -left-4 w-3 h-3 bg-current rounded-full opacity-20 animate-ping"
         [ngClass]="getIconColorClass()"></div>
    <div class="absolute -top-2 -right-6 w-2 h-2 bg-current rounded-full opacity-30 animate-pulse delay-700"
         [ngClass]="getIconColorClass()"></div>
    <div class="absolute -bottom-3 -left-2 w-4 h-4 bg-current rounded-full opacity-15 animate-bounce delay-300"
         [ngClass]="getIconColorClass()"></div>
  </div>
</div>
